(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,9165,e=>{"use strict";var t=e.i(47167);let a={Essential:[{category:"Family Support",examples:["Remittly transfer","Family remittance"]},{category:"Groceries",examples:["FreshCo","No Frills","Costco","Metro"]},{category:"Rent",examples:["Monthly rent payment","Apartment rent"]},{category:"Utilities",examples:["Rogers Internet","Hydro One","Fido Mobile"]},{category:"Immigration",examples:["IRCC fee","IELTS exam","Translation service"]},{category:"Health",examples:["Protein powder","Vitamins","GoodLife Fitness"]},{category:"Home",examples:["IKEA furniture","Mop","Mattress"]},{category:"Personal Development",examples:["Udemy course","Technical books","Coursera"]},{category:"Personal Care",examples:["Toothpaste","Body wash","Haircut"]},{category:"Transportation",examples:["Presto card","Gas station","Enterprise rent"]},{category:"Stationary",examples:["Staples","Notebooks","Printer paper"]},{category:"Investment",examples:["RRSP contribution","TFSA","ETF purchase"]},{category:"Liabilities",examples:["Student loan","Mortgage payment","CRA tax"]},{category:"Miscellaneous",examples:["E-transfer","Cash withdraw"]},{category:"Income",examples:["Monthly salary","Tax return","Refund"]}],Luxury:[{category:"Dine out",examples:["McDonald's","Tim Hortons","Swiss Chalet"]},{category:"Travel",examples:["Airbnb","Air Canada","CN Tower tickets"]},{category:"Shopping",examples:["Tommy Hilfiger","Nike","Souvenir keychain"]},{category:"Home+",examples:["Samsung TV","Projector","PlayStation 5"]},{category:"Subscriptions",examples:["Netflix","Spotify Premium","iCloud+"]},{category:"Gifts",examples:["Anniversary gift","Birthday present"]},{category:"Recreational",examples:["Cineplex","Dave & Buster's","Spa day","Concert tickets"]}],Transfers:[{category:"Transfers",examples:["Account transfer","Credit card payment","Network fees"]}]},r=e=>e[Math.floor(Math.random()*e.length)],o=(e=12)=>{let t=new Date,a=new Date(t.getFullYear(),t.getMonth()-e,1),r=new Date;return new Date(a.getTime()+Math.random()*(r.getTime()-a.getTime()))},s=e=>{let[t,a]={"Family Support":[200,1e3],Groceries:[20,150],Rent:[1200,2500],Utilities:[50,200],Immigration:[100,500],Health:[20,100],Home:[50,500],"Personal Development":[20,200],"Personal Care":[10,80],Transportation:[30,150],Stationary:[5,50],Investment:[100,2e3],Liabilities:[200,1500],Miscellaneous:[10,100],Income:[2e3,5e3],"Dine out":[10,80],Travel:[100,1500],Shopping:[30,300],"Home+":[200,1500],Subscriptions:[10,30],Gifts:[50,200],Recreational:[30,200],Transfers:[50,1e3]}[e]||[10,100];return Math.round((t+Math.random()*(a-t))*100)/100},n=(e=3)=>{let t=[],a=new Date;for(let r=0;r<e;r++){let o=new Date(a.getTime()-(e-r)*6048e5),s=new Date(o.getTime()+1e3),n=new Date(s.getTime()+5e3+1e4*Math.random());t.push({id:`demo-job-${r+1}`,filename:`statement-${2024-r}.pdf`,status:"completed",created_at:o.toISOString(),started_at:s.toISOString(),completed_at:n.toISOString(),error_message:null,transaction_count:50+Math.floor(100*Math.random())})}return t},i=(e=200)=>{let t=[],i=[...a.Essential,...a.Luxury,...a.Transfers],l=n();for(let n=0;n<e;n++){let e=r(i),d=Object.entries(a).find(([,t])=>t.some(t=>t.category===e.category))?.[0]||"Essential",c=o(12),m=r(e.examples),g=s(e.category),u="Income"===e.category?g:-g;t.push({id:n+1,job_id:r(l).id,date:c.toISOString(),title:m,amount:u,currency:"CAD",category_primary:d,category_detailed:e.category,category_confidence_level:r(["high","medium","low"]),created_at:c.toISOString()})}return t.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())};async function l(e){return Promise.resolve({job_id:"demo-job-upload",status:"completed",message:"Demo mode: File upload simulated"})}async function d(e){{let t=n();return Promise.resolve(e?t.filter(t=>t.status===e):t)}}async function c(e){return Promise.resolve()}async function m(e,t=100,a=0){{let r=i(300);return e&&(r=r.filter(t=>t.job_id===e)),Promise.resolve(r.slice(a,a+t))}}async function g(e=10,t="detailed"){return Promise.resolve(((e=10,t="detailed")=>i(300).filter(e=>e.amount<0).sort((e,t)=>Math.abs(t.amount)-Math.abs(e.amount)).slice(0,e).map(e=>({id:e.id,date:new Date(e.date).toLocaleDateString("en-CA"),title:e.title,amount:Math.abs(e.amount),category:"primary"===t?e.category_primary:e.category_detailed})))(e,t))}async function u(e=2,t=10,a="detailed"){return Promise.resolve(((e=2,t=10,a="detailed")=>{let r=i(300).filter(e=>e.amount<0),o=new Map,s=new Map;r.forEach(e=>{let t="primary"===a?e.category_primary:e.category_detailed,r=o.get(t)||0,n=s.get(t)||0;o.set(t,r+Math.abs(e.amount)),s.set(t,n+1)}),o.forEach((e,t)=>{let a=s.get(t)||1;o.set(t,e/a)});let n=[];return r.forEach(t=>{let r="primary"===a?t.category_primary:t.category_detailed,s=o.get(r)||0,i=Math.abs(t.amount),l=s>0?(i-s)/s:0;l>=e&&n.push({id:t.id,date:new Date(t.date).toLocaleDateString("en-CA"),title:t.title,amount:i,category:r,average_amount:Math.round(100*s)/100,deviation_percentage:Math.round(100*l)})}),n.sort((e,t)=>t.deviation_percentage-e.deviation_percentage).slice(0,t)})(e,t,a))}async function y(e="detailed",t=5){return Promise.resolve(((e="detailed",t=5)=>{let a=((e="detailed")=>{let t=[],a=new Date,r=i(300);for(let o=0;o<12;o++){let s=a.getFullYear(),n=a.getMonth()-o+1,i=n<=0?s-1:s,l=n<=0?12+n:n,d=new Date(i,l-1,1),c=new Date(i,l,0,23,59,59),m=r.filter(e=>{let t=new Date(e.date);return t>=d&&t<=c&&e.amount<0}),g=new Map;m.forEach(t=>{let a="primary"===e?t.category_primary:t.category_detailed,r=g.get(a)||{total:0,count:0};g.set(a,{total:r.total+Math.abs(t.amount),count:r.count+1})});let u=Array.from(g.entries()).map(([e,t])=>({category:e,total_amount:Math.round(100*t.total)/100,transaction_count:t.count})),y=u.reduce((e,t)=>e+t.total_amount,0);t.push({year:i,month:l,categories:u,total_spending:Math.round(100*y)/100})}return t.reverse()})(e),r=new Map;return a.forEach(e=>{e.categories.forEach(e=>{let t=r.get(e.category)||0;r.set(e.category,t+e.total_amount)})}),Array.from(r.entries()).sort((e,t)=>t[1]-e[1]).slice(0,t).map(([e])=>e).map(e=>({category:e,data:a.map(t=>{let a=t.categories.find(t=>t.category===e);return{month:`${t.year}-${String(t.month).padStart(2,"0")}`,amount:a?a.total_amount:0}})}))})(e,t))}t.default.env.NEXT_PUBLIC_API_URL,e.s(["deleteJob",()=>c,"getCategoryTrends",()=>y,"getJobs",()=>d,"getTopTransactions",()=>g,"getTransactions",()=>m,"getUnusualTransactions",()=>u,"uploadPdf",()=>l],9165)},71542,e=>{"use strict";var t=e.i(43476),a=e.i(9165),r=e.i(71645);function o({jobs:e,loading:o,onJobDeleted:s}){let[n,i]=(0,r.useState)(null),l=async(e,t)=>{if(confirm(`Are you sure you want to delete "${t}" and all its transactions?`)){i(e);try{await (0,a.deleteJob)(e),s()}catch(e){console.error("Failed to delete job:",e),alert("Failed to delete job. Please try again.")}finally{i(null)}}};return o?(0,t.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-700 dark:bg-slate-800",children:(0,t.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"Loading..."})}):0===e.length?(0,t.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-700 dark:bg-slate-800",children:(0,t.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:"No uploads yet. Upload a PDF to get started."})}):(0,t.jsx)("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white shadow-sm dark:border-gray-700 dark:bg-slate-800",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[(0,t.jsx)("thead",{className:"bg-gray-50 dark:bg-slate-900",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Filename"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Transactions"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Created"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium uppercase tracking-wider text-gray-500 dark:text-gray-400",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white dark:divide-gray-700 dark:bg-slate-800",children:e.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-slate-700",children:[(0,t.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.filename}),(0,t.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:(0,t.jsx)("span",{className:`inline-flex rounded-full px-2 text-xs font-semibold leading-5 ${function(e){switch(e){case"completed":return"bg-green-100 text-green-800 dark:bg-green-900/40 dark:text-green-300";case"processing":return"bg-blue-100 text-blue-800 dark:bg-blue-900/40 dark:text-blue-300";case"failed":return"bg-red-100 text-red-800 dark:bg-red-900/40 dark:text-red-300";default:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/40 dark:text-yellow-300"}}(e.status)}`,children:e.status})}),(0,t.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-900 dark:text-gray-100",children:e.transaction_count??"-"}),(0,t.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:new Date(e.created_at).toLocaleString()}),(0,t.jsx)("td",{className:"whitespace-nowrap px-6 py-4 text-sm",children:(0,t.jsx)("button",{onClick:()=>l(e.id,e.filename),disabled:n===e.id,className:"text-red-600 hover:text-red-900 disabled:cursor-not-allowed disabled:opacity-50 dark:text-red-400 dark:hover:text-red-300",children:n===e.id?"Deleting...":"Delete"})})]},e.id))})]})})}var s=e.i(932);function n(e){let a,r,o,n,i=(0,s.c)(10),{file:l,uploading:d,onFileChange:c,onSubmit:m}=e;i[0]===Symbol.for("react.memo_cache_sentinel")?(a=(0,t.jsx)("label",{htmlFor:"file-upload",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Select PDF File"}),i[0]=a):a=i[0],i[1]!==c?(r=(0,t.jsxs)("div",{children:[a,(0,t.jsx)("input",{id:"file-upload",type:"file",accept:".pdf",onChange:c,className:"mt-1 block w-full text-sm text-gray-900 file:mr-4 file:rounded-md file:border-0 file:bg-indigo-50 file:px-4 file:py-2 file:text-sm file:font-semibold file:text-indigo-700 hover:file:bg-indigo-100 dark:text-gray-100 dark:file:bg-indigo-900/40 dark:file:text-indigo-300 dark:hover:file:bg-indigo-900/60"})]}),i[1]=c,i[2]=r):r=i[2];let g=!l||d,u=d?"Uploading...":"Upload";return i[3]!==g||i[4]!==u?(o=(0,t.jsx)("button",{type:"submit",disabled:g,className:"inline-flex justify-center rounded-md bg-indigo-600 px-4 py-2 text-sm font-semibold text-white shadow-sm transition-colors hover:bg-indigo-500 disabled:cursor-not-allowed disabled:opacity-50 dark:bg-indigo-500 dark:hover:bg-indigo-400",children:u}),i[3]=g,i[4]=u,i[5]=o):o=i[5],i[6]!==m||i[7]!==r||i[8]!==o?(n=(0,t.jsx)("div",{className:"rounded-lg border border-gray-200 bg-white p-6 shadow-sm dark:border-gray-700 dark:bg-slate-800",children:(0,t.jsxs)("form",{onSubmit:m,className:"space-y-4",children:[r,o]})}),i[6]=m,i[7]=r,i[8]=o,i[9]=n):n=i[9],n}function i(){let[e,s]=(0,r.useState)(null),[i,l]=(0,r.useState)(!1),[d,c]=(0,r.useState)([]),[m,g]=(0,r.useState)(!0),[u,y]=(0,r.useState)(null),p=async()=>{try{let e=await (0,a.getJobs)();c(e),y(null)}catch(e){y("Failed to fetch jobs"),console.error(e)}finally{g(!1)}};(0,r.useEffect)(()=>{p();let e=setInterval(p,5e3);return()=>clearInterval(e)},[]);let x=async t=>{if(t.preventDefault(),e){l(!0);try{await (0,a.uploadPdf)(e),s(null);let t=document.getElementById("file-upload");t&&(t.value=""),await p()}catch(e){y("Failed to upload file"),console.error(e)}finally{l(!1)}}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Upload PDF Statement"}),(0,t.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Upload a bank statement PDF to extract transactions using AI"})]}),(0,t.jsx)(n,{file:e,uploading:i,onFileChange:e=>{e.target.files&&e.target.files[0]&&s(e.target.files[0])},onSubmit:x}),u&&(0,t.jsx)("div",{className:"rounded-md bg-red-50 p-4 dark:bg-red-900/20",children:(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-400",children:u})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Upload History"}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(o,{jobs:d,loading:m,onJobDeleted:p})})]})]})}e.s(["default",()=>i],71542)}]);